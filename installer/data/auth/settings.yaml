global:
  debug: false
  disable_auth: false
  # forced_info:
  #   raw:
  #     auth: true
  #     auth_errors: []
  #     auth_nameid: ""
  #     auth_sessionindex: ""
  #     auth_attributes: {}


# vault:
#   url: https://vault.example.com:8200
#   ssl_verify: true
#   namespace: some/namespace
#   secrets_path: secrets
#   secrets_mount_point: kv
#   # auth_token: t...n
#   # auth_username: u..r
#   # auth_password: p......d
#   auth_role_id: r....d
#   auth_secret_id: s......d


server:
  global:
    environment: production
    engine.signals.on: true
    server.socket_host: 0.0.0.0
    server.socket_port: 80
    server.thread_pool: 8
    server.max_request_body_size: 0
    server.socket_timeout: 60

  "/":
    tools.sessions.on: true
    tools.sessions.name: auth_session_id
    tools.sessions.domain: localhost
    tools.sessions.httponly: true
    tools.sessions.secure: false
    tools.proxy.on: true
    tools.proxy.local: Host
    tools.secureheaders.on: true
    tools.staticdir.on: true
    tools.staticdir.dir: static


endpoints:
  root: "/forward-auth/"
  saml: "/forward-auth/saml"
  oidc: "/forward-auth/oidc"
  info: "/forward-auth/info"
  access_denied: "/access_denied"


auth:
  auth_redirect: "http://localhost/forward-auth/login"
  login_handler: "/forward-auth/oidc/login"
  logout_handler: "/forward-auth/oidc/logout"
  # login_handler: "/forward-auth/saml/login"
  # logout_handler: "/forward-auth/saml/logout"
  login_default_redirect_url: http://localhost/
  logout_default_redirect_url: http://localhost/
  logout_allowed_redirect_urls:
  - http://localhost/


mappers:
  header:
    grafana:
      X-WEBAUTH-USER: "'auth_attributes'.'preferred_username'"
      X-WEBAUTH-NAME: "'auth_attributes'.'name'"
      X-WEBAUTH-EMAIL: "'auth_attributes'.'email'"
  json:
    galloper:
      login: "'auth_attributes'.'preferred_username'"
      name: "'auth_attributes'.'name'"
      email: "'auth_attributes'.'email'"


saml:
  strict: false
  debug: false

  sp:
    entityId: carrier-saml
    assertionConsumerService:
      url: http://localhost/forward-auth/saml/acs
      binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST
    singleLogoutService:
      url: http://localhost/forward-auth/saml/sls
      binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST
    NameIDFormat: urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified
    x509cert: ${KEYCLOAK_SP_CERT}
    privateKey: ${KEYCLOAK_PRIVATE_KEY}

  idp:
    entityId: http://localhost/auth/realms/test
    singleSignOnService:
      url: http://localhost/auth/realms/test/protocol/saml
      binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST
    singleLogoutService:
      url: http://localhost/auth/realms/test/protocol/saml
      binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST
    x509cert: ${KEYCLOAK_IDP_CERT}

  security:
    authnRequestsSigned: true
    logoutRequestSigned: true
    signatureAlgorithm: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
    digestAlgorithm: http://www.w3.org/2001/04/xmlenc#sha256


oidc:
  debug: true

  provider:
    configuration:
      issuer: "http://localhost/auth/realms/test"
      authorization_endpoint: "http://localhost/auth/realms/test/protocol/openid-connect/auth"
      token_endpoint: "http://keycloak:8080/auth/realms/test/protocol/openid-connect/token"
      token_introspection_endpoint: "http://localhost/auth/realms/test/protocol/openid-connect/token/introspect"
      userinfo_endpoint: "http://keycloak:8080/auth/realms/test/protocol/openid-connect/userinfo"
      end_session_endpoint: "http://localhost/auth/realms/test/protocol/openid-connect/logout"
      jwks_uri: "http://keycloak:8080/auth/realms/test/protocol/openid-connect/certs"
      check_session_iframe: "http://localhost/auth/realms/test/protocol/openid-connect/login-status-iframe.html"
      grant_types_supported: ["authorization_code","implicit","refresh_token","password","client_credentials"]
      response_types_supported: ["code","none","id_token","token","id_token token","code id_token","code token","code id_token token"]
      subject_types_supported: ["public","pairwise"]
      id_token_signing_alg_values_supported: ["PS384","ES384","RS384","HS256","HS512","ES256","RS256","HS384","ES512","PS256","PS512","RS512"]
      id_token_encryption_alg_values_supported: ["RSA-OAEP","RSA1_5"]
      id_token_encryption_enc_values_supported: ["A128GCM","A128CBC-HS256"]
      userinfo_signing_alg_values_supported: ["PS384","ES384","RS384","HS256","HS512","ES256","RS256","HS384","ES512","PS256","PS512","RS512","none"]
      request_object_signing_alg_values_supported: ["PS384","ES384","RS384","ES256","RS256","ES512","PS256","PS512","RS512","none"]
      response_modes_supported: ["query","fragment","form_post"]
      registration_endpoint: "http://localhost/auth/realms/test/clients-registrations/openid-connect"
      token_endpoint_auth_methods_supported: ["private_key_jwt","client_secret_basic","client_secret_post","tls_client_auth","client_secret_jwt"]
      token_endpoint_auth_signing_alg_values_supported: ["PS384","ES384","RS384","ES256","RS256","ES512","PS256","PS512","RS512"]
      claims_supported: ["aud","sub","iss","auth_time","name","given_name","family_name","preferred_username","email","acr"]
      claim_types_supported: ["normal"]
      claims_parameter_supported: False
      scopes_supported: ["openid","offline_access","profile","email","address","phone","roles","web-origins","microprofile-jwt"]
      request_parameter_supported: True
      request_uri_parameter_supported: True
      code_challenge_methods_supported: ["plain","S256"]
      tls_client_certificate_bound_access_tokens: True
      introspection_endpoint: "http://localhost/auth/realms/test/protocol/openid-connect/token/introspect"

    registration:
      client_id: carrier-oidc
      client_secret: 565c7a98-0f30-4acf-8dcd-e8c0fe7df06e
      redirect_uris:
      - "http://localhost/forward-auth/oidc/callback"
      post_logout_redirect_uris:
      - "http://localhost"
